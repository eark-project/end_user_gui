@functions
{
    public virtual string getSpanId()
    {
        return ViewBag.SpanPrefix + ViewBag.Id;
    }

    RouteValueDictionary saveRouteValues()
    {
        var ret = new RouteValueDictionary();
        ret.Add(ViewBag.KeyColumn, ViewBag.Id);
        return ret;
    }

    RouteValueDictionary cancelRouteValues()
    {
        var ret = new RouteValueDictionary();
        ret.Add(ViewBag.KeyColumn, ViewBag.Id);
        ret.Add("set", false);
        ret.Add(ViewBag.Column, "");
        return ret;
    }
}

@RenderSection("Select")

@Ajax.ActionLink("Save",
    (string)ViewBag.Action,
    (string)ViewBag.Controller,
    saveRouteValues(),
    new AjaxOptions()
    {
        UpdateTargetId = getSpanId()
    },
    new string[1].ToDictionary<string, string, object>((a) => "save", (a) => true)
    )

@Ajax.ActionLink("Cancel",
    (string)ViewBag.Action,
    (string)ViewBag.Controller,
    cancelRouteValues(),
    new AjaxOptions()
    {
        UpdateTargetId = getSpanId()
    }
    )


<script>
    function containerSpanId(elm) {
        var span = elm;
        while (span.tagName.toLowerCase() != 'span')
            span = span.parentElement;
        elementId = span.getAttribute('id');
        return elementId;
    }

    function updateStatusLink(select) {

        var elementId = containerSpanId(select)
        var a = $('#' + elementId + ' a[save]');
        if (!a.attr('orgHref')) {
            a.attr('orgHref', a.attr('href'));
        }
        a.attr(
            'href',
            a.attr('orgHref') + '&@{Output.Write(ViewBag.Column);}=' + select.value + '&set=true'
        );
    }
</script>
